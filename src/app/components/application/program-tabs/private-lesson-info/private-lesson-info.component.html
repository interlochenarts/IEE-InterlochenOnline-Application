<header>
  <div class="row">
    <div class="col-12">
      <h3>Select a Private Lesson</h3>
    </div>
  </div>
</header>

<div *ngIf="isLoading">
  <i class="fa fa-2x fa-spinner fa-pulse fa-fw"></i> Loading
</div>

<div *ngIf="!isLoading">
  <div class="col-12 my-4" *ngIf="selectedPrograms.length > 0">
    <h5>Selected Programs</h5>
    <div *ngFor="let program of selectedPrograms" class="checkbox-container col-12 align-items-center d-flex my-3"
         [ngClass]="{disabled: program.isDisabled(daysSelectedBySession, programsDisabled, ListTypes.SELECTED)}">
      <div class="checkbox col-3 col-md-2 text-center" *ngIf="!program.isSaving"
           (click)="clickProgram(program, newLessonModal, ListTypes.SELECTED)">
        <input *ngIf="!program.isRegistered" type="checkbox" [id]="program.id" [name]="program.id"
               [checked]="program.isSelected"
               [disabled]="program.isDisabled(daysSelectedBySession, programsDisabled, ListTypes.SELECTED)">
        <label *ngIf="!program.isRegistered"
               [ngClass]="{disabled: program.isDisabled(daysSelectedBySession, programsDisabled, ListTypes.SELECTED)}">
          <i class="fa fa-check ps-4"></i>
        </label>
      </div>
      <div class="checkbox col-3 col-md-2 text-center" *ngIf="program.isSaving">
        <i class="fa fa-2x fa-spinner fa-pulse fa-fw"></i>
      </div>
      <div class="col-9 col-md-10 description">
        <h4 class="d-inline">{{ program.name }}  {{ program.selectedInstrument }}</h4>
        <span class="float-end" *ngIf="program.isRegistered && program.lessonCountAdd < 1"> {{ program.lessonCount }}
          Lessons <a href="javascript:void(0);" (click)="addLessons(program, addLessonsModal, ListTypes.SELECTED)"> Add Lessons</a></span>
        <span class="float-end" *ngIf="program.isRegistered && program.lessonCountAdd > 0"> {{ program.lessonCount }}
          Lessons <span class="reviewError">+{{ program.lessonCountAdd }} pending </span> <a
            href="javascript:void(0);" (click)="addLessons(program, addLessonsModal, ListTypes.SELECTED)"> Update Pending</a></span>
        <span class="float-end" *ngIf="!program.isRegistered"> {{ program.lessonCount }} Lessons <a
          href="javascript:void(0);" (click)="addLessons(program, addLessonsModal, ListTypes.SELECTED)"> Update Lessons</a></span>
      </div>
    </div>
  </div>

  <div class="col-12 my-4">
    <h5>Available Private Lessons</h5>
    <div *ngFor="let program of filteredLessons" class="checkbox-container col-12 align-items-center d-flex my-3"
         (click)="clickProgram(program, newLessonModal, ListTypes.FILTERED)"
         [ngClass]="{disabled: program.isDisabled(daysSelectedBySession, programsDisabled, ListTypes.FILTERED)}">
      <div class="checkbox col-3 col-md-2 text-center" *ngIf="!program.isSaving">
        <input type="checkbox" [id]="program.id" [name]="program.id"
               [checked]="program.isSelected"
               [disabled]="program.isDisabled(daysSelectedBySession, programsDisabled, ListTypes.FILTERED)">
        <label [ngClass]="{disabled: program.isDisabled(daysSelectedBySession, programsDisabled, ListTypes.FILTERED)}">
          <i class="fa fa-check ps-4"></i>
        </label>
      </div>
      <div class="checkbox col-3 col-md-2 text-center" *ngIf="program.isSaving">
        <i class="fa fa-2x fa-spinner fa-pulse fa-fw"></i>
      </div>
      <div class="col-9 col-md-10 description">
        <h4>{{ program.name }}</h4>
        <p>{{ program.division }} - {{ program.artsAreaList }}</p>
      </div>
    </div>
  </div>
</div>

<ng-template #addLessonsModal let-modal>
  <div class="modal-header">
    <h4 *ngIf="modalList === ListTypes.SELECTED" class="modal-title" id="modal-basic-title">Adjust Lessons</h4>
    <h4 *ngIf="modalList === ListTypes.REGISTERED " class="modal-title" id="modal-basic-title">Select number of additional
      lessons</h4>
    <button type="button" class="close btn btn-sm" aria-label="Close"
            (click)="modal.dismiss('Close clicked')">
      <span aria-hidden="true">
      <i class="fa fa-close fa-2x"></i></span>
    </button>
  </div>
  <div class="modal-body">
    <label *ngIf="modalList === ListTypes.SELECTED" for="lessonCountAdd" class="mt-4 required">Number of lessons (max 52)</label>
    <label *ngIf="modalList === ListTypes.REGISTERED" for="lessonCountAdd" class="mt-4 required">
      Number of lessons (max {{ 52 - modalExistingCount }})</label>
    <div class="default required">
      <input type="number" class="w-25"
             [(ngModel)]="modalLessonCountAdd"
             name="lessonCountAdd"
             max="52"
             id="lessonCountAdd"/>
    </div>
  </div>
  <div class="modal-footer">

    <button *ngIf="modalList === ListTypes.SELECTED" type="button" class="btn btn-primary"
            [disabled]=" modalLessonCountAdd < 1 || modalLessonCountAdd > 52"
            (click)="modal.close(modalInstrumentChoice)">Ok
    </button>
    <button *ngIf="modalList === ListTypes.REGISTERED" type="button" class="btn btn-primary"
            [disabled]=" modalLessonCountAdd < 0 || (modalExistingCount + modalLessonCountAdd) > 52"
            (click)="modal.close(modalInstrumentChoice)">Ok
    </button>

  </div>
</ng-template>


<ng-template #newLessonModal let-modal>
  <div class="modal-header">
    <h4 *ngIf="isMusic" class="modal-title" id="modal-basic-title">Select an Instrument and Number of lessons</h4>
    <h4 *ngIf="!isMusic" class="modal-title" id="modal-basic-title">Select Number of lessons</h4>
    <button type="button" class="close btn btn-sm" aria-label="Close" (click)="modal.dismiss('Close clicked')">
      <span aria-hidden="true">
        <i class="fa fa-close fa-2x"></i>
      </span>
    </button>
  </div>
  <div class="modal-body">
    <label *ngIf="isMusic" for="selectedInstrument" class="mt-4 required">Instrument</label>
    <div *ngIf="isMusic" class="default required">
      <div class="select">
        <select [(ngModel)]="modalInstrumentChoice"
                name="selectedInstrument"
                class="w-100"
                id="selectedInstrument">
          <option *ngFor="let instrument of selectedProgramInstruments" [value]="instrument.value"
                  [disabled]="instrument.disabled"
                  [defaultSelected]="instrument.defaultValue">{{ instrument.label }}
          </option>
        </select>
      </div>
    </div>

    <label for="lessonCount" class="mt-4 required">Add lessons (max 52)</label>
    <div class="default required">
      <input type="number" class="w-25"
             [(ngModel)]="modalLessonCount"
             name="lessonCount"
             max="52"
             id="lessonCount"/>
    </div>
  </div>
  <div class="modal-footer">

    <button *ngIf="isMusic" type="button" class="btn btn-primary"
            [disabled]="(!modalInstrumentChoice || !modalLessonCount) || modalLessonCount < 0 || modalLessonCount > 52"
            (click)="closeNewLessonModal(modal)">Ok
    </button>
    <button *ngIf="!isMusic" type="button" class="btn btn-primary"
            [disabled]="!modalLessonCount || modalLessonCount < 0 || modalLessonCount > 52"
            (click)="closeNewLessonModal(modal)">Ok
    </button>

  </div>
</ng-template>
